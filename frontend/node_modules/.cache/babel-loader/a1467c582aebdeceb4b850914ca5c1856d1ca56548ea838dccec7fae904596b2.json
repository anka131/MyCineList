{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\aleee\\\\OneDrive\\\\Desktop\\\\Projects\\\\MyCineList\\\\frontend\\\\src\\\\utils\\\\MovieContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useEffect, useState } from \"react\";\nimport { useMovies } from './useMovies';\nimport { useAuth } from \"./useAuth\";\nimport { getFavorites, addFavorite, removeFavorite } from './api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const MovieContext = /*#__PURE__*/createContext();\nexport const MovieProvider = function ({\n  children\n}) {\n  _s();\n  const [query, setQuery] = useState(\"\");\n  const [selectedId, setSelectedId] = useState(null);\n  const {\n    movies,\n    isLoading,\n    error\n  } = useMovies(query);\n  const [watched, setWatched] = useState([]);\n  const {\n    token\n  } = useAuth();\n  useEffect(() => {\n    const fetchFavorites = async () => {\n      if (token) {\n        try {\n          const res = await getFavorites(token);\n          setWatched(res.data.savedMovies || []);\n        } catch (err) {\n          console.error(\"Failed to fetch watched movies\", err);\n        }\n      }\n    };\n    fetchFavorites();\n  }, [token]);\n  function handleSelectMovie(id) {\n    setSelectedId(prev => id === prev ? null : id);\n  }\n  function handleCloseMovie() {\n    setSelectedId(null);\n  }\n  async function handleAddWatched(movie) {\n    try {\n      await addFavorite(token, movie);\n      setWatched(prev => [...prev, movie]);\n    } catch (err) {\n      console.error(\"Failed to add movie to watched\", err);\n    }\n  }\n  async function handleDeleteWatched(id) {\n    try {\n      await removeFavorite(token, id);\n      setWatched(prev => prev.filter(movie => movie.id !== id));\n    } catch (err) {\n      console.error(\"Failed to delete movie from watched\", err);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(MovieContext.Provider, {\n    value: {\n      query,\n      setQuery,\n      selectedId,\n      setSelectedId,\n      movies,\n      isLoading,\n      error,\n      watched,\n      handleSelectMovie,\n      handleCloseMovie,\n      handleAddWatched,\n      handleDeleteWatched\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n};\n_s(MovieProvider, \"DZ8eIqgejXyxb2aMsIbDyf3HeyI=\", false, function () {\n  return [useMovies, useAuth];\n});\n_c = MovieProvider;\nvar _c;\n$RefreshReg$(_c, \"MovieProvider\");","map":{"version":3,"names":["createContext","useEffect","useState","useMovies","useAuth","getFavorites","addFavorite","removeFavorite","jsxDEV","_jsxDEV","MovieContext","MovieProvider","children","_s","query","setQuery","selectedId","setSelectedId","movies","isLoading","error","watched","setWatched","token","fetchFavorites","res","data","savedMovies","err","console","handleSelectMovie","id","prev","handleCloseMovie","handleAddWatched","movie","handleDeleteWatched","filter","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/aleee/OneDrive/Desktop/Projects/MyCineList/frontend/src/utils/MovieContext.js"],"sourcesContent":["import { createContext, useEffect, useState } from \"react\";\r\nimport {useMovies} from './useMovies';\r\nimport { useAuth } from \"./useAuth\";\r\n\r\nimport {getFavorites, addFavorite, removeFavorite} from './api';\r\n\r\nexport const MovieContext = createContext();\r\n\r\n\r\nexport const MovieProvider = function({ children }) {\r\n  const [query, setQuery] = useState(\"\");\r\n  const [selectedId, setSelectedId] = useState(null);\r\n\r\n const {movies, isLoading, error} = useMovies(query);\r\n const[watched, setWatched] = useState([]);\r\n const {token} = useAuth();\r\n\r\n useEffect(()=>{\r\n  const fetchFavorites = async () => {\r\n    if(token){\r\n      try{\r\n        const res = await getFavorites(token);\r\n        setWatched(res.data.savedMovies || []);\r\n      }catch(err){\r\n        console.error(\"Failed to fetch watched movies\", err);\r\n      }\r\n    }\r\n  }\r\n  fetchFavorites();\r\n },[token])\r\n\r\n  function handleSelectMovie(id){\r\n    setSelectedId((prev) => id === prev ? null : id);\r\n  }\r\n  function handleCloseMovie(){\r\n    setSelectedId(null);\r\n  }\r\n\r\n  async function handleAddWatched(movie){\r\n    try{\r\n       await addFavorite(token, movie);\r\n      setWatched((prev) => [...prev, movie]);\r\n    }catch(err){\r\n      console.error(\"Failed to add movie to watched\", err);\r\n    }\r\n  }\r\n  async function handleDeleteWatched(id){\r\n    try{\r\n       await removeFavorite(token, id);\r\n      setWatched((prev) => prev.filter((movie) => movie.id !== id));\r\n    }catch(err) {\r\n      console.error(\"Failed to delete movie from watched\", err);\r\n    }\r\n  }\r\n  return(\r\n    <MovieContext.Provider value={({\r\n        query,\r\n        setQuery,\r\n        selectedId,\r\n        setSelectedId,\r\n        movies,\r\n        isLoading,\r\n        error,\r\n        watched,\r\n        handleSelectMovie,\r\n        handleCloseMovie,\r\n        handleAddWatched,\r\n        handleDeleteWatched,\r\n    })}>\r\n        {children}\r\n    </MovieContext.Provider>\r\n  )\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}